<?php

namespace WS\OvsBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * EvenementRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class EvenementRepository extends EntityRepository {

    public function triSport($actif) {
        $qb = $this->createQueryBuilder('e');
        $qb->where('e.actif=:actif')
                ->setParameter('actif', $actif)
                ->leftJoin('e.sport', 's')
                ->orderBy('s.nom');
        return $qb->getQuery()->getResult();
    }

    public function triUser($actif) {
        $qb = $this->createQueryBuilder('e');
        $qb->where('e.actif=:actif')
                ->setParameter('actif', $actif)
                ->leftJoin('e.user', 'u')
                ->orderBy('u.username');
        return $qb->getQuery()->getResult();
    }

    public function recherche($recherche) {
        $qb = $this->createQueryBuilder('e');
        $qb->where('e.actif=:actif')
                ->setParameter('actif', 1)
                ->andWhere($qb->expr()->like('e.ville', ':recherche'))
                ->setParameter('recherche', '%' . $recherche . '%');
        return $qb->getQuery()->getResult();
    }

}
