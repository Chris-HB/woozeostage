{% extends 'WSOvsBundle::layout.html.twig' %}

{% block title %}
    {{ parent() }} - evenement
{% endblock %}
{% block ovs %}
    <p>{{ evenement. nom }} par {{ evenement.user.username }}</p>
    <p>le {{ evenement.date|date('d/m/Y') }} à {{ evenement.heure|date('H:i')}}</p>
    <p>Type de sport : {{ evenement.sport.nom }}<p>
    <p>Description
        <br/>
       {{ evenement.descriptif|raw }}
    </p>
    {% if evenement.modification is not null %}
        <p>Cet évènement a était modifié : 
            <br/>
            {{ evenement.modification|nl2br }}
        </p>
    {% endif %}
    <p>Nombre de place maximun {{ evenement.inscrit }}</p>
    <p>Adresse
        <br/>
        {{ evenement.adresse|nl2br }}
        <div id="map">
        </div>
    </p>
    <p>Liste des inscrits ({{ userEvenementValides|length }}/{{ evenement.inscrit }} reste {{ evenement.inscrit - userEvenementValides|length }})<p>
    {% for ue in userEvenementValides %}
        <p>{{ ue.user.username }}</p>
    {% endfor %}
    <p>Liste d'attente ({{ userEvenementAttentes|length }})</p>
    {% for ue in userEvenementAttentes %}
        <p>{{ ue.user.username }}</p>
    {% endfor %}
    <p>
        {% if app.user == evenement.user %}
            <a href="{{ path('ws_ovs_evenement_desactiver', {'id': evenement.id}) }}">Supprimer cette sortie</a>
            <a href="{{ path('ws_ovs_evenement_gerer', {'id': evenement.id}) }}">Gerer les inscrits</a>
            <a href="{{ path('ws_ovs_evenement_modifier', {'id': evenement.id}) }}">Modifier l'évènement</a>
        {% else %}
            {% set present = false %}
            {% for us in evenement.userEvenements %}
                {% if us.user == app.user %}
                    {% set present = true %}
                {% endif %}
            {% endfor %}
            {% if present == true %}
                <a href="{{ path('ws_ovs_userevenement_modifier', {'id': evenement.id}) }}">Modifier ma participation</a>
            {% else %}
                {% if "now"|date('Y-m-d H:i:s') < dateEvenement|date('Y-m-d H:i:s') %}
                    <a href="{{ path('ws_ovs_userevenement_add', {id: evenement.id}) }}">S'inscrire à lévènement</a>
                {% endif %}
            {% endif %}
        {% endif %}
    </p>
    {{ render(controller('WSOvsBundle:Commentaire:list', {'id':evenement.id})) }}
    {{ render(controller('WSOvsBundle:Commentaire:add', {'id':evenement.id})) }}
    {#<a href="{{ path('ws_ovs_commentaire_add', {'id':evenement.id}) }}">ajouter com</a>#}
    <p><a href="{{ path('ws_ovs_evenement_list') }}">Retour à la liste des évènements</a></p>
{% endblock %}
